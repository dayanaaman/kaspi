<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Документы</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background: #f9f9f9;
      color: #000;
    }
    .tabs {
      display: flex;
      justify-content: space-around;
      background: #fff;
      border-bottom: 1px solid #ddd;
    }
    .tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      color: #000; /* всегда чёрный */
    }
    .tab.active {
      font-weight: bold;
      border-bottom: 2px solid #007aff;
    }
    .content {
      padding: 15px;
    }
    .photo-container img {
      width: 100%;
      border-radius: 12px;
    }
    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
      margin: 10px 0;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      text-decoration: none;
    }
    .btn-primary {
      background: #007aff;
      color: #fff;
    }
    .btn-outline {
      border: 1px solid #007aff;
      color: #007aff;
    }
    .btn img {
      width: 20px;
      margin-right: 8px;
    }
    /* Фон модалки */
    #modalBg {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.2);
      z-index: 999;
    }
    /* Сама модалка снизу */
    .modal {
      position: fixed;
      bottom: -100%;
      left: 0;
      width: 100%;
      height: 45%;
      background: #fff;
      border-top-left-radius: 16px;
      border-top-right-radius: 16px;
      padding: 20px;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
      transition: bottom 0.3s ease;
      z-index: 1000;
    }
    .modal.show {
      bottom: 0;
    }
    .modal .close {
      font-size: 22px;
      float: right;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- Вкладки -->
  <div class="tabs">
    <div class="tab active" onclick="showTab('doc')">Документ</div>
    <div class="tab" onclick="showTab('info')">Реквизиты</div>
  </div>

  <!-- Документ -->
  <div id="doc" class="content">
    <input type="file" id="uploadPhoto" accept="image/*">
    <div class="photo-container">
      <img id="documentPhoto" src="" alt="Документ">
    </div>
    <div id="docButtons" style="display:none;">
      <a href="#" class="btn btn-primary" onclick="openModal()">
        <img src="icon.png" alt="">Предъявить документ
      </a>
      <a href="#" class="btn btn-outline">
        <img src="imgbin.png" alt="">Отправить документ
      </a>
    </div>
  </div>

  <!-- Реквизиты -->
  <div id="info" class="content" style="display:none;">
    <!-- Форма -->
    <div id="infoForm">
      <input id="fio" placeholder="ФИО"><br><br>
      <input id="iin" placeholder="ИИН"><br><br>
      <label>Дата рождения:</label><br>
      <input id="dob" type="date"><br><br>
      <input id="docnum" placeholder="Номер документа"><br><br>
      <label>Дата выдачи:</label><br>
      <input id="issued" type="date"><br><br>
      <label>Срок действия:</label><br>
      <input id="expiry" type="date"><br><br>
      <button onclick="finalize()">Сохранить</button>
    </div>

    <!-- Готовый документ -->
    <div id="infoView" style="display:none; text-align:left; font-size:16px; line-height:1.6;">
      <p><b>ФИО:</b> <span id="viewFio"></span></p>
      <p><b>ИИН:</b> <span id="viewIin"></span></p>
      <p><b>Дата рождения:</b> <span id="viewDob"></span></p>
      <p><b>Номер документа:</b> <span id="viewDocnum"></span></p>
      <p><b>Дата выдачи:</b> <span id="viewIssued"></span></p>
      <p><b>Срок действия:</b> <span id="viewExpiry"></span></p>
      <button onclick="editInfo()">Редактировать</button>
    </div>
  </div>

  <!-- Фон и модалка -->
  <div id="modalBg" onclick="closeModal()"></div>
  <div id="modal" class="modal">
    <span class="close" onclick="closeModal()">×</span>
    <div style="text-align:left;font-weight:bold;font-size:18px;margin-bottom:20px;">
      Удостоверение личности
    </div>
    <div style="text-align:center;font-size:14px;margin-bottom:20px;">
      Покажите QR-код сотруднику
    </div>
    <div style="text-align:center;margin-bottom:15px;">
      <img src="QR.png" alt="QR Code" style="width:150px;height:150px;object-fit:cover;border-radius:10px;">
    </div>
    <div style="text-align:center;font-size:14px;margin-bottom:10px;">
      или скажите код
    </div>
    <div style="text-align:center;font-weight:bold;font-size:24px;">
      803558
    </div>
  </div>

  <script>
    // Переключение вкладок
    function showTab(id) {
      document.getElementById('doc').style.display = id === 'doc' ? 'block' : 'none';
      document.getElementById('info').style.display = id === 'info' ? 'block' : 'none';
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelector(`.tab[onclick="showTab('${id}')"]`).classList.add('active');
    }

    // Формат даты
    function formatDate(dateStr) {
      if (!dateStr) return "";
      const d = new Date(dateStr);
      if (isNaN(d)) return dateStr;
      let day = String(d.getDate()).padStart(2, '0');
      let month = String(d.getMonth() + 1).padStart(2, '0');
      let year = d.getFullYear();
      return `${day}.${month}.${year}`;
    }

    // Сохранение реквизитов
    function finalize() {
      ["fio","iin","dob","docnum","issued","expiry"].forEach(id=>{
        const val = document.getElementById(id).value;
        if(val) localStorage.setItem(id,val);
      });
      document.getElementById("viewFio").textContent = localStorage.getItem("fio") || "";
      document.getElementById("viewIin").textContent = localStorage.getItem("iin") || "";
      document.getElementById("viewDob").textContent = formatDate(localStorage.getItem("dob"));
      document.getElementById("viewDocnum").textContent = localStorage.getItem("docnum") || "";
      document.getElementById("viewIssued").textContent = formatDate(localStorage.getItem("issued"));
      document.getElementById("viewExpiry").textContent = formatDate(localStorage.getItem("expiry"));
      document.getElementById("infoForm").style.display="none";
      document.getElementById("infoView").style.display="block";
    }

    function editInfo() {
      document.getElementById("infoForm").style.display="block";
      document.getElementById("infoView").style.display="none";
    }

    // Фото
    const upload = document.getElementById("uploadPhoto");
    const docPhoto = document.getElementById("documentPhoto");
    upload.addEventListener("change", function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          docPhoto.src = e.target.result;
          localStorage.setItem("documentPhoto", e.target.result);
          document.getElementById("docButtons").style.display = "block";
          upload.style.display = "none";
        };
        reader.readAsDataURL(file);
      }
    });

    // При загрузке страницы
    window.onload = function() {
      const savedPhoto = localStorage.getItem("documentPhoto");
      if (savedPhoto) {
        docPhoto.src = savedPhoto;
        document.getElementById("docButtons").style.display = "block";
        upload.style.display = "none";
      }
      let saved = false;
      ["fio","iin","dob","docnum","issued","expiry"].forEach(id=>{
        let val = localStorage.getItem(id);
        if(val){
          document.getElementById(id).value = val;
          saved = true;
        }
      });
      if(saved) finalize();
    };

    // Модалка
    function openModal() {
      document.getElementById("modalBg").style.display="block";
      document.getElementById("modal").classList.add("show");
    }
    function closeModal() {
      document.getElementById("modalBg").style.display="none";
      document.getElementById("modal").classList.remove("show");
    }
  </script>
</body>
</html>
